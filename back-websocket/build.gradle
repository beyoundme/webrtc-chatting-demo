plugins {
    id 'java'
}

group 'com.beyoundme'
version '1.0-SNAPSHOT'

sourceCompatibility = 1.8
targetCompatibility = 1.8
tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

repositories {
    mavenCentral()
}

dependencies {
    compile group: 'com.alibaba', name: 'fastjson', version: '1.2.7'
    compile group: 'log4j', name: 'log4j', version: '1.2.17'
    compile 'org.springframework.boot:spring-boot-starter-web:2.2.1.RELEASE'
    compile 'org.springframework.boot:spring-boot-starter:2.2.1.RELEASE'
    compile 'org.springframework.boot:spring-boot-starter-test:2.2.1.RELEASE'
    compile 'org.springframework.boot:spring-boot-starter-websocket:2.2.1.RELEASE'
    compile 'org.projectlombok:lombok:1.16.10'
}
jar {
    String someString = ''
    configurations.runtime.each { someString = someString + " lib/" + it.name }

    manifest {
        attributes 'Main-Class': 'com.beyoundme.Application'
        attributes 'Class-Path': someString
        baseName 'back-websocket'
    }
}

task copyLib(type: Copy) {
    from configurations.runtime
    into('build/libs/lib')
}
jar.dependsOn(copyLib)